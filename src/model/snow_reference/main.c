//
//  main.c
//  RefImp
//
//  Created by Patrik Ekdahl on 2024-03-04.
//

#include <stdio.h>
#include "typeconst.h"
#include "snow_v.h"
#include "snow_vi.h"
#include "debug.h"


/*
 Test data
 */
const uint8_t key[][32] = {
    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
    { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff },
    { 0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57,
        0x58, 0x59, 0x5a, 0x5b, 0x5c, 0x5d, 0x5e, 0x5f,
        0x0a, 0x1a, 0x2a, 0x3a, 0x4a, 0x5a, 0x6a, 0x7a,
        0x8a, 0x9a, 0xaa, 0xba, 0xca, 0xda, 0xea, 0xfa }
};

const uint8_t iv[][16] = {
    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
    { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff },
    { 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef,
        0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10 }
};


void SNOW_V_Testvectors(void) {
    int testidx;
    int i;
    
    printf("---- SNOW V TESTVECTORS ----\n");
    for(testidx = 0; testidx < 3; testidx++) {
        printf("Test set: %d\n",testidx + 1);
        print_u8("Key : ", key[testidx], 32);
        print_u8("IV  : ", iv[testidx], 16);

        SNOW_V_Init(key[testidx], iv[testidx]);
        
        printf("Output keystream : \n");
        for(i = 0; i < 8; i++) {
            u128 z = SNOW_V_Keystream();
            print_128(0, z);
        }
    }
    
}


void SNOW_Vi_Testvectors(void) {
    int testidx;
    int i;
    
    printf("---- SNOW Vi TESTVECTORS ----\n");
    for(testidx = 0; testidx < 3; testidx++) {
        printf("Test set: %d\n",testidx + 1);
        print_u8("Key : ", key[testidx], 32);
        print_u8("IV  : ", iv[testidx], 16);

        SNOW_Vi_Init(key[testidx], iv[testidx]);
        
        printf("Output keystream : \n");
        for(i = 0; i < 8; i++) {
            u128 z = SNOW_Vi_Keystream();
            print_128(0, z);
        }
    }
    
}


int main(int argc, const char * argv[]) {

    SNOW_V_Testvectors();

    SNOW_Vi_Testvectors();

    return 0;
}
